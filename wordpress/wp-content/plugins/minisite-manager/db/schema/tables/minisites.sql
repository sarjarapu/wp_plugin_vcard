CREATE TABLE {$prefix}minisites (
    id VARCHAR(32) NOT NULL,
    slug VARCHAR(255) NULL,
    business_slug VARCHAR(120) NULL,
    location_slug VARCHAR(120) NULL,
    title VARCHAR(200) NOT NULL,
    name VARCHAR(200) NOT NULL,
    city VARCHAR(120) NOT NULL,
    region VARCHAR(120) NULL,
    country_code CHAR(2) NOT NULL,
    postal_code VARCHAR(20) NULL,
    location_point POINT NULL,
    site_template VARCHAR(32) NOT NULL DEFAULT 'v2025',
    palette VARCHAR(24) NOT NULL DEFAULT 'blue',
    industry VARCHAR(40) NOT NULL DEFAULT 'services',
    default_locale VARCHAR(10) NOT NULL DEFAULT 'en-US',
    schema_version SMALLINT UNSIGNED NOT NULL DEFAULT 1,
    site_version INT UNSIGNED NOT NULL DEFAULT 1,
    site_json LONGTEXT NOT NULL,
    search_terms TEXT NULL,
    status ENUM('draft','published','archived') NOT NULL DEFAULT 'published',
    publish_status ENUM('draft','reserved','published') NOT NULL DEFAULT 'draft',
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    published_at DATETIME NULL,
    created_by BIGINT UNSIGNED NULL,
    updated_by BIGINT UNSIGNED NULL,
    _minisite_current_version_id BIGINT UNSIGNED NULL,
    PRIMARY KEY (id),
    UNIQUE KEY uniq_slug (slug),
    UNIQUE KEY uniq_business_location (business_slug, location_slug)
) ENGINE=InnoDB {$charset};